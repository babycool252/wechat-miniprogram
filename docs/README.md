# 记账城市 WeChat Mini Program

## 项目概述

记账城市是一款结合记账功能和城市建设游戏的微信小程序。用户可以记录日常收支，每笔交易都会在用户的虚拟城市中添加一个建筑。随着记账数量的增加，用户的城市将不断发展壮大。

## 功能特点

- **基础记账功能**：记录收入和支出，包括金额、分类、描述、位置和日期
- **城市建设游戏**：每笔交易会在城市中添加一个对应的建筑
- **建筑升级系统**：相同类型和等级的建筑可以合并升级
- **特殊建筑**：在特定位置记录特定类型的交易可以解锁特殊建筑（如在北京记录住房类交易可以建造宫殿）
- **交易统计分析**：查看不同时间段的收支情况和分类明细

## 技术架构

### 前端（微信小程序）

- **框架**：微信小程序原生框架（MINA）
- **UI设计**：简约高级的设计风格，符合中国用户审美
- **文件结构**：
  - `pages/`: 页面文件
  - `components/`: 组件文件
  - `services/`: API服务层
  - `utils/`: 工具函数
  - `assets/`: 静态资源

### 后端（FastAPI）

- **框架**：FastAPI
- **数据库**：SQLite（通过SQLAlchemy ORM）
- **API端点**：
  - 交易管理
  - 分类管理
  - 城市和建筑管理
  - 统计分析

## 页面说明

### 首页（index）

首页展示应用的主要功能入口，包括记账、城市查看和统计分析。设计简洁明了，突出核心功能。

### 交易列表（transactions）

展示用户的所有交易记录，支持下拉刷新和点击查看详情。每条记录显示分类、金额、日期和位置等信息。

### 交易表单（transaction-form）

用于添加或编辑交易记录，包括类型、金额、分类、描述、位置和日期等字段。表单验证确保数据的完整性。

### 城市视图（city-view）

展示用户的虚拟城市，使用Canvas绘制10x10的网格和建筑。支持建筑选择、查看详情和合并升级功能。

### 统计分析（summary）

展示用户的财务统计数据，包括总收入、总支出、结余和分类明细。支持按不同时间段（日、周、月、年）查看数据。

## API服务层

API服务层封装了与后端的通信逻辑，使用`wx.request`替代Web版本的`fetch`/`axios`。主要功能包括：

- 交易管理（获取、创建、更新、删除）
- 分类管理（获取分类列表）
- 城市和建筑管理（获取城市数据、建筑列表、合并建筑）
- 统计分析（获取交易汇总数据）

## 设计风格

应用采用简约（简约）且高级（高级）的设计风格，主要特点包括：

- **配色方案**：以蓝色为主色调，搭配白色和浅灰色背景，营造清新专业的感觉
- **字体层级**：清晰的字体大小和权重层级，提高可读性和视觉层次感
- **卡片式布局**：使用卡片组件展示信息，增加内容的区分度
- **动画效果**：适当的过渡动画提升用户体验，如点击反馈、面板滑入等
- **图标使用**：简洁的图标设计，提升界面美观度和功能识别度

## 本地开发

1. 安装微信开发者工具
2. 导入项目（需要AppID）
3. 在项目设置中配置服务器地址（后端API地址）
4. 启动后端服务器（FastAPI）
5. 在开发者工具中编译和预览

## 部署说明

### 小程序部署

1. 在微信公众平台注册小程序账号
2. 在开发者工具中上传代码
3. 提交审核并发布

### 后端部署

1. 将FastAPI应用部署到云服务器
2. 配置域名和HTTPS
3. 在小程序中更新API基础URL

## 注意事项

- 小程序包大小限制为2MB，需要注意资源优化
- 后端API需要配置正确的CORS设置
- 小程序不支持某些Web API，需要使用微信提供的替代API
- 建议使用云开发或云服务器部署后端，确保稳定性和安全性
